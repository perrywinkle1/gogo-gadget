╔══════════════════════════════════════════════════════════════════════════════╗
║                        JARVIS-V2 SYSTEM ARCHITECTURE                         ║
║                      Chief of Product Pattern (Overseer)                     ║
╚══════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────────────────────────────────────────────────────────────┐
│                                 USER INPUT                                   │
│                                                                              │
│    jarvis-v2 --swarm 3 "Add JWT authentication and PostgreSQL database"     │
│                                     │                                        │
└─────────────────────────────────────┼────────────────────────────────────────┘
                                      ▼
┌──────────────────────────────────────────────────────────────────────────────┐
│                              TASK ANALYZER                                   │
│                                                                              │
│    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                    │
│    │ Complexity  │    │  Domains    │    │Technologies │                    │
│    │   Score     │    │  Detected   │    │  Detected   │                    │
│    │    6/10     │    │ • auth      │    │ • jwt       │                    │
│    │             │    │ • database  │    │ • postgres  │                    │
│    └─────────────┘    └─────────────┘    └─────────────┘                    │
│                                     │                                        │
└─────────────────────────────────────┼────────────────────────────────────────┘
                                      ▼
╔══════════════════════════════════════════════════════════════════════════════╗
║                              SWARM SYSTEM                                    ║
╠══════════════════════════════════════════════════════════════════════════════╣
║                                                                              ║
║  ┌─────────────────────────────────────────────────────────────────────────┐ ║
║  │                      🧠 BRAIN (SwarmCoordinator)                        │ ║
║  │                                                                         │ ║
║  │   ┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────┐           │ ║
║  │   │Decompose │──▶│ Execute  │──▶│Aggregate │──▶│ Verify   │           │ ║
║  │   │  Task    │   │ Subtasks │   │ Results  │   │  Work    │           │ ║
║  │   └──────────┘   └──────────┘   └──────────┘   └────┬─────┘           │ ║
║  │         │                                           │                  │ ║
║  │         │              ┌────────────────────────────┘                  │ ║
║  │         │              │ Next Iteration                                │ ║
║  │         │              ▼                                               │ ║
║  │         └──────────────●                                               │ ║
║  └─────────────────────────┼───────────────────────────────────────────────┘ ║
║                            │                                                 ║
║                            ▼ writes                                          ║
║  ┌─────────────────────────────────────────────────────────────────────────┐ ║
║  │                     📋 SHARED CONTEXT                                   │ ║
║  │                                                                         │ ║
║  │  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐       │ ║
║  │  │   Task     │  │   Phase    │  │  Subtasks  │  │Suggestions │       │ ║
║  │  │"Add JWT...│  │ Executing  │  │ [Agent 1]  │  │[jwt-skill] │       │ ║
║  │  │           │  │            │  │ [Agent 2]  │  │[pg-pool]   │       │ ║
║  │  └────────────┘  └────────────┘  └────────────┘  └────────────┘       │ ║
║  └─────────────────────────┼───────────────────────────────────────────────┘ ║
║                            │                                                 ║
║                            ▼ reads                                           ║
║  ┌─────────────────────────────────────────────────────────────────────────┐ ║
║  │                   🎨 CREATIVE OVERSEER                                  │ ║
║  │                   (Chief of Product)                                    │ ║
║  │                                                                         │ ║
║  │   ┌──────────┐   ┌──────────┐   ┌──────────┐   ┌──────────┐           │ ║
║  │   │ Observe  │──▶│Brainstorm│──▶│Synthesize│──▶│ Suggest  │           │ ║
║  │   │ Context  │   │  Ideas   │   │Capability│   │ to Brain │           │ ║
║  │   └──────────┘   └──────────┘   └──────────┘   └──────────┘           │ ║
║  │                                       │                                │ ║
║  └───────────────────────────────────────┼─────────────────────────────────┘ ║
║                                          │                                   ║
╚══════════════════════════════════════════┼═══════════════════════════════════╝
                                           │
                                           ▼
┌──────────────────────────────────────────────────────────────────────────────┐
│                          🧰 CAPABILITY SYSTEM                                │
│                                                                              │
│   ┌─────────────────┐   ┌─────────────────┐   ┌─────────────────┐           │
│   │  📝 SKILLS      │   │  🔌 MCP SERVERS │   │  🤖 AGENTS      │           │
│   │                 │   │                 │   │                 │           │
│   │ jwt-auth.md     │   │ postgres-mcp    │   │ security-       │           │
│   │ pg-pool.md      │   │ stripe-mcp      │   │ reviewer.md     │           │
│   │ ...             │   │ ...             │   │ ...             │           │
│   └────────┬────────┘   └────────┬────────┘   └────────┬────────┘           │
│            │                     │                     │                    │
│            └─────────────────────┼─────────────────────┘                    │
│                                  ▼                                          │
│                        ┌─────────────────┐                                  │
│                        │   HOT LOADER    │                                  │
│                        │ ~/.claude/skills│                                  │
│                        └────────┬────────┘                                  │
│                                 │                                           │
│                                 ▼                                           │
│                        ┌─────────────────┐                                  │
│                        │    REGISTRY     │                                  │
│                        │capabilities.json│                                  │
│                        └─────────────────┘                                  │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
                                           │
                                           ▼
┌──────────────────────────────────────────────────────────────────────────────┐
│                            🤖 PARALLEL AGENTS                                │
│                                                                              │
│    ┌────────────────┐    ┌────────────────┐    ┌────────────────┐           │
│    │    AGENT 1     │    │    AGENT 2     │    │    AGENT N     │           │
│    │                │    │                │    │                │           │
│    │ Implementation │    │    Review &    │    │      ...       │           │
│    │   JWT + DB     │    │  Verification  │    │                │           │
│    │                │    │                │    │                │           │
│    │  ┌──────────┐  │    │  ┌──────────┐  │    │  ┌──────────┐  │           │
│    │  │ Has new  │  │    │  │ Has new  │  │    │  │ Has new  │  │           │
│    │  │ skills   │  │    │  │ skills   │  │    │  │ skills   │  │           │
│    │  │ available│  │    │  │ available│  │    │  │ available│  │           │
│    │  └──────────┘  │    │  └──────────┘  │    │  └──────────┘  │           │
│    └────────────────┘    └────────────────┘    └────────────────┘           │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
                              PHASE STATE MACHINE
═══════════════════════════════════════════════════════════════════════════════

    ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
    │  Analyzing  │────▶│ Decomposing │────▶│  Executing  │────▶│ Aggregating │
    └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
                                                                       │
          ┌────────────────────────────────────────────────────────────┘
          │
          ▼
    ┌─────────────┐
    │  Verifying  │─────────────────────┐
    └─────────────┘                     │
          │                             │
          ├──── Pass ────▶ ┌──────────┐ │
          │                │ Complete │ │
          │                └──────────┘ │
          │                             │
          └──── Fail ────▶ ┌──────────┐ │
                           │  Failed  │ │
                           └──────────┘ │
                                        │
          ┌─────────────────────────────┘
          │ Next Iteration
          ▼
    ┌─────────────┐
    │ Decomposing │  (loop continues)
    └─────────────┘


═══════════════════════════════════════════════════════════════════════════════
                                 KEY INSIGHT
═══════════════════════════════════════════════════════════════════════════════

    The Creative Overseer (Chief of Product) doesn't wait for failures.
    It PROACTIVELY observes what the swarm is working on and creates
    capabilities that would help - before agents even need them.

    Brain writes ──▶ SharedContext ◀── Overseer reads
                          │
                          ▼
                   Creates tools BEFORE
                   agents encounter gaps

═══════════════════════════════════════════════════════════════════════════════
